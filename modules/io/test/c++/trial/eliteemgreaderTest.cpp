#include <cxxtest/TestDrive.h>

#include <openma/io.h>
#include <openma/base/node.h>
#include <openma/base/timesequence.h>

#include "test_file_path.h"

CXXTEST_SUITE(EliteEmgReaderTest)
{
  CXXTEST_TEST(capability)
  {
    ma::io::HandlerReader reader(nullptr,"bts.emg");
    TS_ASSERT_EQUALS(reader.canRead(), false);
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    reader.setDevice(&file);
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.format(), "bts.emg");
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(supportedTrialFormats)
  {
    ma::io::HandlerReader reader;
    auto formats = reader.availableFormats();
    TS_ASSERT_EQUALS(std::find(formats.cbegin(), formats.cend(), "bts.emg") != formats.cend(), true);
  };
  
  CXXTEST_TEST(detectNoDevice)
  {
    ma::io::HandlerReader reader;
    TS_ASSERT_EQUALS(reader.canRead(), false);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::Device);
  };
  
  CXXTEST_TEST(detectDeviceNotOpen)
  {
    ma::io::File file;
    ma::io::HandlerReader reader(&file);
    TS_ASSERT_EQUALS(reader.canRead(), false);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::Device);
  };

  CXXTEST_TEST(detectEmptyFile)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/empty/Empty.emg"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file);
    TS_ASSERT_EQUALS(reader.canRead(), false);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::InvalidData);
  };

  CXXTEST_TEST(detectFail)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/Fail.c3d"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file);
    TS_ASSERT_EQUALS(reader.canRead(), false);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::Device);
  };

  CXXTEST_TEST(detectOk)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file);
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(queryOkOne)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file, "bts.emg");
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(queryOkTwo)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader(nullptr, "bts.emg");
    reader.setDevice(&file);
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(queryOkThree)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader;
    reader.setDevice(&file);
    reader.setFormat("bts.emg");
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(detectVariantEmr)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMR"), ma::io::Mode::In);
    ma::io::HandlerReader reader;
    reader.setDevice(&file);
    reader.setFormat("bts.emg");
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(detectVariantEmf)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMF"), ma::io::Mode::In);
    ma::io::HandlerReader reader;
    reader.setDevice(&file);
    reader.setFormat("bts.emg");
    TS_ASSERT_EQUALS(reader.canRead(), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
  };
  
  CXXTEST_TEST(file1123xa01G)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file, "bts.emg");
    ma::Node root("root");
    TS_ASSERT_EQUALS(reader.read(&root), true);
    TS_ASSERT_EQUALS(root.children().size(), 1u);
    auto analogs = root.findChildren<ma::TimeSequence*>();
    TS_ASSERT_EQUALS(analogs.size(), 8u);
    for (auto analog : analogs)
    {
      TS_ASSERT_EQUALS(analog->startTime(), 0.0);
      TS_ASSERT_EQUALS(analog->sampleRate(), 1000.0);
      TS_ASSERT_EQUALS(analog->components(), 1u);
      TS_ASSERT_EQUALS(analog->samples(), 4564u);
      TS_ASSERT_EQUALS(analog->unit(), "mV");
    }
    TS_ASSERT_EQUALS(analogs[0]->name(), "R_RF");
    TS_ASSERT_EQUALS(analogs[1]->name(), "R_BFCL");
    TS_ASSERT_EQUALS(analogs[2]->name(), "R_TA");
    TS_ASSERT_EQUALS(analogs[3]->name(), "R_GAL");
    TS_ASSERT_EQUALS(analogs[4]->name(), "L_RF");
    TS_ASSERT_EQUALS(analogs[5]->name(), "L_BFCL");
    TS_ASSERT_EQUALS(analogs[6]->name(), "L_TA");
    TS_ASSERT_EQUALS(analogs[7]->name(), "L_GAL");
    ma::Node ref("ref");
    TS_ASSERT_EQUALS(ma::io::read(&ref, OPENMA_TDD_PATH_IN("c3d/other/1123x01EMG.c3d")),true);
    auto aref = ref.findChildren<ma::TimeSequence*>();
    for (int i = 1 ; i < 50 ; i+=10)
    {
      TS_ASSERT_DELTA(analogs[0]->data()[i], aref[0]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[1]->data()[i], aref[1]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[2]->data()[i], aref[2]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[3]->data()[i], aref[3]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[4]->data()[i], aref[4]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[5]->data()[i], aref[5]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[6]->data()[i], aref[6]->data()[i], 1e-5);
      TS_ASSERT_DELTA(analogs[7]->data()[i], aref[7]->data()[i], 1e-5);
    }
  };

  CXXTEST_TEST(file1123xa01F)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMF"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file, "bts.emg");
    ma::Node root("root");
    TS_ASSERT_EQUALS(reader.read(&root), true);
    TS_ASSERT_EQUALS(root.children().size(), 1u);
    auto analogs = root.findChildren<ma::TimeSequence*>();
    TS_ASSERT_EQUALS(analogs.size(), 8u);
    for (auto analog : analogs)
    {
      TS_ASSERT_EQUALS(analog->startTime(), 0.0);
      TS_ASSERT_EQUALS(analog->sampleRate(), 1000.0);
      TS_ASSERT_EQUALS(analog->components(), 1u);
      TS_ASSERT_EQUALS(analog->samples(), 4564u);
      TS_ASSERT_EQUALS(analog->unit(), "mV");
    }
    TS_ASSERT_EQUALS(analogs[0]->name(), "R_RF");
    TS_ASSERT_EQUALS(analogs[1]->name(), "R_BFCL");
    TS_ASSERT_EQUALS(analogs[2]->name(), "R_TA");
    TS_ASSERT_EQUALS(analogs[3]->name(), "R_GAL");
    TS_ASSERT_EQUALS(analogs[4]->name(), "L_RF");
    TS_ASSERT_EQUALS(analogs[5]->name(), "L_BFCL");
    TS_ASSERT_EQUALS(analogs[6]->name(), "L_TA");
    TS_ASSERT_EQUALS(analogs[7]->name(), "L_GAL");
  };
  
  CXXTEST_TEST(file1123xa01R)
  {
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/1123xa01/1123xa01.EMR"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file, "bts.emg");
    ma::Node root("root");
    TS_ASSERT_EQUALS(reader.read(&root), true);
    TS_ASSERT_EQUALS(root.children().size(), 1u);
    auto analogs = root.findChildren<ma::TimeSequence*>();
    TS_ASSERT_EQUALS(analogs.size(), 8u);
    for (auto analog : analogs)
    {
      TS_ASSERT_EQUALS(analog->startTime(), 0.0);
      TS_ASSERT_EQUALS(analog->sampleRate(), 1000.0);
      TS_ASSERT_EQUALS(analog->components(), 1u);
      TS_ASSERT_EQUALS(analog->samples(), 4564u);
      TS_ASSERT_EQUALS(analog->unit(), "mV");
    }
    TS_ASSERT_EQUALS(analogs[0]->name(), "R_RF");
    TS_ASSERT_EQUALS(analogs[1]->name(), "R_BFCL");
    TS_ASSERT_EQUALS(analogs[2]->name(), "R_TA");
    TS_ASSERT_EQUALS(analogs[3]->name(), "R_GAL");
    TS_ASSERT_EQUALS(analogs[4]->name(), "L_RF");
    TS_ASSERT_EQUALS(analogs[5]->name(), "L_BFCL");
    TS_ASSERT_EQUALS(analogs[6]->name(), "L_TA");
    TS_ASSERT_EQUALS(analogs[7]->name(), "L_GAL");
  };
  
  CXXTEST_TEST(file22XXXC0B)
  {
    const unsigned samples = 4522u;
    double ref_L_RF[samples] = {708.008, -830.078, 1030.273, 1625.977, -131.836, 913.086, -1669.922, -2514.648, -566.406, 1293.945, 644.531, 73.242, 561.523, 654.297, -283.203, -751.953, 444.336, -449.219, -1118.164, 703.125, -747.07, -869.141, -58.594, 1254.883, 2685.547, 2524.414, -1694.336, -3188.477, -1684.57, 1030.273, 146.484, 893.555, -244.141, 732.422, -166.016, -2578.125, 297.852, 2158.203, 1132.813, 463.867, -1538.086, -166.016, 43.945, -1684.57, 292.969, 1542.969, 1391.602, 136.719, 126.953, -883.789, -1601.563, 209.961, 2612.305, 449.219, -683.594, -3911.133, 546.875, 1835.938, 1347.656, 209.961, -849.609, 449.219, 537.109, 346.68, -1103.516, -1372.07, -112.305, 776.367, -1289.063, -434.57, 190.43, -356.445, 512.695, 766.602, -1333.008, 107.422, 2319.336, 1318.359, -19.531, -1425.781, -659.18, -1035.156, 537.109, 1298.828, 732.422, -1210.938, 634.766, 971.68, -1655.273, -1621.094, -957.031, 976.563, 1455.078, 322.266, 449.219, -292.969, -1704.102, -1206.055, 1772.461, 1367.188, -493.164, -341.797, -429.688, -932.617, -576.172, 1313.477, 1176.758, -131.836, -19.531, -1455.078, 1020.508, 1220.703, -732.422, -898.438, -839.844, 253.906, 415.039, 410.156, -341.797, -195.313, 473.633, 615.234, 112.305, -634.766, -1127.93, -214.844, 395.508, 1166.992, 1245.117, -922.852, -795.898, -385.742, 483.398, 87.891, 107.422, 0, 131.836, -1215.82, -273.438, 488.281, 161.133, 34.18, 19.531, 283.203, 317.383, 717.773, -39.063, -395.508, -317.383, -126.953, -346.68, 756.836, 546.875, -859.375, -698.242, -83.008, 312.5, 493.164, -249.023, -302.734, 322.266, 166.016, -24.414, -131.836, -195.313, 9.766, 239.258, 122.07, 239.258, -332.031, 209.961, -131.836, -24.414, -19.531, -34.18, -102.539, 19.531, -63.477, 541.992, -34.18, -732.422, 400.391, 166.016, 53.711, -693.359, 39.063, 78.125, 53.711, 68.359, 73.242, 136.719, 92.773, 34.18, 87.891, 107.422, -200.195, -517.578, -112.305, 268.555, 449.219, 136.719, -200.195, -419.922, -83.008, 102.539, 53.711, -141.602, 4.883, 24.414, 73.242, 73.242, 4.883, 19.531, 4.883, -29.297, 58.594, 68.359, 625, 434.57, -141.602, -742.188, -43.945, 214.844, 209.961, -610.352, -273.438, -122.07, 14.648, 58.594, 87.891, 112.305, 53.711, 117.188, 117.188, 136.719, 131.836, 156.25, 156.25, -166.016, -258.789, -39.063, -19.531, -9.766, 4.883, -4.883, -19.531, -78.125, -48.828, 4.883, 83.008, 83.008, 112.305, 39.063, -9.766, 0, -48.828, -39.063, -34.18, 4.883, 29.297, 78.125, 24.414, 9.766, -34.18, -87.891, -48.828, -131.836, -43.945, -43.945, -43.945, 14.648, -4.883, 0, -9.766, 19.531, 4.883, -24.414, 19.531, 39.063, 53.711, 122.07, 34.18, 73.242, -19.531, -102.539, 34.18, 78.125, -126.953, -68.359, 78.125, 83.008, 107.422, -63.477, 0, 78.125, 43.945, 92.773, 43.945, 48.828, 24.414, 19.531, -14.648, -53.711, -19.531, 9.766, -53.711, -14.648, -63.477, -53.711, -39.063, 9.766, -9.766, -58.594, -73.242, -58.594, -24.414, 0, -29.297, -24.414, -39.063, -73.242, -48.828, -19.531, -14.648, 14.648, -29.297, 19.531, 19.531, -4.883, 29.297, -4.883, 24.414, 0, 9.766, 9.766, 14.648, 4.883, 9.766, 19.531, 34.18, -29.297, 19.531, 0, 9.766, -43.945, 29.297, 0, -73.242, -78.125, 4.883, -39.063, 14.648, 24.414, 14.648, 151.367, 9.766, -107.422, -126.953, -39.063, 43.945, -39.063, -43.945, 14.648, -63.477, -19.531, 29.297, 29.297, -14.648, -24.414, 78.125, 39.063, 78.125, 14.648, 0, 24.414, 83.008, 29.297, 48.828, 107.422, 14.648, 53.711, 24.414, 4.883, 29.297, 0, 0, 14.648, 58.594, 9.766, 0, -48.828, -24.414, -4.883, -4.883, -14.648, -63.477, 34.18, -39.063, -19.531, -29.297, 9.766, -19.531, 0, 14.648, -19.531, 9.766, 0, 19.531, -4.883, 34.18, 4.883, -9.766, 29.297, 0, -48.828, 34.18, 19.531, -9.766, -14.648, -19.531, -9.766, 4.883, -9.766, -43.945, 0, -19.531, -29.297, -14.648, 0, -9.766, -53.711, -53.711, -63.477, -34.18, -24.414, -24.414, -53.711, -48.828, 9.766, 4.883, 4.883, 0, -34.18, -34.18, 14.648, 24.414, 14.648, -4.883, 0, 9.766, 24.414, -9.766, 19.531, 24.414, -4.883, 0, -29.297, -19.531, 14.648, 43.945, 34.18, -9.766, -9.766, 117.188, 9.766, -39.063, -131.836, -39.063, -14.648, 48.828, -29.297, -24.414, 102.539, 58.594, -209.961, -317.383, -454.102, 175.781, 781.25, 1337.891, 1826.172, 708.008, -429.688, -2675.781, -2304.688, 224.609, -43.945, 83.008, 9.766, -209.961, -151.367, -48.828, 415.039, 434.57, 620.117, 429.688, 253.906, 73.242, -78.125, -136.719, -136.719, 4.883, 209.961, 400.391, 439.453, 312.5, 175.781, -48.828, -190.43, -244.141, -195.313, -117.188, 68.359, 131.836, 141.602, 9.766, -53.711, -161.133, -351.563, -346.68, -219.727, -156.25, -19.531, 34.18, 126.953, 87.891, -24.414, -29.297, -190.43, -131.836, -102.539, 29.297, 78.125, 136.719, 161.133, 234.375, 92.773, -4.883, -43.945, 9.766, -14.648, 14.648, 24.414, 161.133, 39.063, 87.891, -4.883, 9.766, 112.305, -43.945, -395.508, -117.188, 9.766, 102.539, -29.297, -14.648, -68.359, -63.477, -166.016, -136.719, -205.078, -39.063, 34.18, 58.594, 24.414, -9.766, -39.063, -19.531, -14.648, 14.648, -34.18, 19.531, 58.594, 68.359, 97.656, 63.477, 58.594, 4.883, 34.18, -14.648, -34.18, 19.531, -4.883, 14.648, -34.18, -39.063, -58.594, 0, -117.188, -48.828, -43.945, 53.711, 83.008, 39.063, 24.414, 117.188, -53.711, -249.023, -170.898, -48.828, 63.477, 195.313, -78.125, 14.648, 83.008, -43.945, 39.063, 63.477, 43.945, 43.945, 24.414, 63.477, -122.07, 29.297, 200.195, 48.828, -141.602, 48.828, -4.883, 19.531, 9.766, 4.883, 14.648, -9.766, 4.883, -19.531, -4.883, 43.945, 24.414, -34.18, -78.125, 24.414, -43.945, -53.711, -4.883, -29.297, -4.883, -9.766, -9.766, 117.188, 14.648, -112.305, -14.648, -68.359, -39.063, 209.961, 102.539, -136.719, -29.297, -34.18, -9.766, 24.414, 63.477, 73.242, -9.766, 24.414, -9.766, 34.18, 0, 19.531, -4.883, 9.766, -29.297, -4.883, -14.648, 24.414, -24.414, 4.883, 0, 48.828, -14.648, 4.883, 4.883, 14.648, 0, 14.648, 29.297, -29.297, 24.414, 63.477, 19.531, -9.766, 24.414, -14.648, -4.883, -24.414, -14.648, 19.531, -4.883, 19.531, 39.063, 14.648, -48.828, 4.883, -48.828, -9.766, 29.297, 9.766, 0, 4.883, 4.883, 0, -24.414, 0, -39.063, 24.414, 0, -9.766, 48.828, 19.531, -14.648, -48.828, 43.945, -151.367, 14.648, 14.648, -19.531, -53.711, -9.766, 14.648, -19.531, -117.188, 92.773, 141.602, -112.305, -258.789, 117.188, 156.25, 102.539, -205.078, -9.766, 43.945, 4.883, 258.789, 249.023, 112.305, -117.188, -810.547, -493.164, 97.656, 58.594, 92.773, 288.086, 219.727, 205.078, -278.32, -29.297, 34.18, 112.305, 131.836, 122.07, -253.906, -195.313, -249.023, -68.359, -249.023, 219.727, 92.773, 117.188, 195.313, 97.656, 141.602, -146.484, 112.305, 4.883, 53.711, 161.133, 405.273, 791.016, -58.594, -419.922, -874.023, 4.883, -141.602, -527.344, -322.266, 209.961, 68.359, -493.164, 473.633, 981.445, 546.875, -4.883, -654.297, -239.258, -1181.641, -92.773, 844.727, 234.375, -380.859, 351.563, -48.828, -488.281, 654.297, 898.438, 395.508, -122.07, -229.492, -444.336, 991.211, 781.25, -1054.688, -39.063, 610.352, 78.125, 668.945, 1347.656, -1401.367, -2705.078, -766.602, 898.438, 283.203, 39.063, -429.688, -273.438, -78.125, 87.891, 258.789, 1376.953, 292.969, -205.078, 175.781, 83.008, -737.305, -1801.758, -976.563, 151.367, 512.695, 1074.219, 996.094, -1972.656, 693.359, 1308.594, 937.5, -1235.352, -576.172, 483.398, 1098.633, 278.32, -629.883, 53.711, 170.898, -766.602, 200.195, 1118.164, -234.375, -1914.063, -322.266, 820.313, -502.93, 361.328, 468.75, -253.906, -581.055, -390.625, 307.617, 361.328, 112.305, -502.93, -39.063, -229.492, 1025.391, 1049.805, -961.914, 48.828, -1572.266, 327.148, 1269.531, -332.031, -751.953, -625, -68.359, 239.258, 878.906, 1264.648, 629.883, -1899.414, -1088.867, 439.453, 1118.164, 1269.531, 83.008, -1684.57, 952.148, -625, 200.195, 1191.406, -375.977, -1586.914, 141.602, 639.648, -576.172, -1455.078, 791.016, 527.344, -610.352, -58.594, 2265.625, 258.789, -1372.07, -405.273, 600.586, 1474.609, -2114.258, -463.867, 883.789, 361.328, 219.727, -1674.805, 19.531, 1713.867, -380.859, -2963.867, 68.359, 346.68, 703.125, 1015.625, 117.188, 195.313, -927.734, 932.617, 29.297, -1411.133, 356.445, 1391.602, 1494.141, -195.313, -1264.648, -1298.828, 947.266, 1542.969, -307.617, -869.141, -502.93, 307.617, -883.789, -332.031, -131.836, 1152.344, -58.594, 258.789, -561.523, -546.875, -234.375, 683.594, 415.039, -136.719, -126.953, 332.031, -1406.25, -175.781, 571.289, 1323.242, 209.961, -693.359, -527.344, 644.531, 1289.063, 517.578, -1591.797, -200.195, -703.125, -341.797, 410.156, 795.898, 1279.297, -1328.125, -927.734, 927.734, -561.523, -1694.336, 1220.703, 1274.414, 341.797, -903.32, -1318.359, 2011.719, 493.164, -2480.469, 48.828, 1333.008, 708.008, 209.961, 200.195, -278.32, -727.539, -415.039, 351.563, 791.016, -205.078, -1088.867, 419.922, -976.563, 805.664, 1074.219, 122.07, 34.18, -1235.352, -498.047, 1425.781, 48.828, -737.305, 1528.32, 942.383, -1528.32, -1171.875, -1040.039, -527.344, 2016.602, -63.477, -39.063, 1010.742, 126.953, -1005.859, 1083.984, -458.984, -2451.172, -1479.492, 2255.859, 1547.852, 1215.82, -1660.156, -2456.055, 2231.445, 439.453, -268.555, -1162.109, 2841.797, -952.148, 195.313, -703.125, -1313.477, 903.32, 1679.688, -1567.383, -1220.703, -239.258, -463.867, 2001.953, 1206.055, 209.961, -1552.734, -878.906, 1586.914, -268.555, -244.141, -263.672, -795.898, 449.219, 1879.883, 1088.867, -3681.641, -1362.305, 332.031, 1264.648, -595.703, 268.555, -356.445, 1723.633, 2094.727, -317.383, -1943.359, 1616.211, 532.227, -2197.266, -1254.883, 1923.828, 571.289, 463.867, 351.563, -1845.703, -1743.164, 2319.336, 1328.125, 78.125, -1596.68, -971.68, 659.18, -73.242, 307.617, -185.547, 112.305, -1391.602, -717.773, 917.969, -122.07, 1049.805, -146.484, 903.32, -585.938, -595.703, -1298.828, 805.664, 126.953, -942.383, 1562.5, 1303.711, -581.055, -927.734, -605.469, 1035.156, 1655.273, 1030.273, -1357.422, -2866.211, 878.906, 1708.984, 815.43, 537.109, -2094.727, -1093.75, -297.852, -839.844, 1064.453, 1875, -1494.141, -600.586, 810.547, 2324.219, 253.906, -336.914, -2446.289, 458.984, 742.188, 400.391, 1376.953, 429.688, -590.82, -2993.164, -63.477, -1625.977, 1152.344, 1298.828, 253.906, 639.648, 205.078, -268.555, -2216.797, 180.664, 1489.258, 1103.516, -732.422, -786.133, -1616.211, 361.328, -9.766, 610.352, 615.234, -336.914, 48.828, 58.594, 366.211, 78.125, 351.563, 932.617, 859.375, -742.188, -1235.352, -893.555, 581.055, -874.023, -473.633, 1264.648, 1313.477, 1010.742, -2333.984, -1450.195, 986.328, -107.422, 751.953, 2241.211, 556.641, -2866.211, -791.016, 107.422, 1147.461, -771.484, 1069.336, -761.719, -2265.625, -415.039, 1196.289, 1162.109, 1723.633, -683.594, -1547.852, -458.984, -395.508, 966.797, 1323.242, 932.617, -219.727, -297.852, -1186.523, 224.609, 131.836, -1152.344, 981.445, 2524.414, -1079.102, -3642.578, 1210.938, 332.031, -917.969, 78.125, -219.727, 1137.695, 1250, 585.938, -156.25, -2187.5, -498.047, 649.414, 771.484, 170.898, -146.484, 92.773, 34.18, 9.766, -654.297, 346.68, 878.906, -122.07, -600.586, -24.414, -673.828, 727.539, 1220.703, -991.211, -1445.313, 200.195, 297.852, 517.578, 1074.219, -224.609, -688.477, -307.617, 253.906, -14.648, 693.359, 283.203, -288.086, -239.258, -214.844, -1420.898, 253.906, -439.453, 146.484, 410.156, 400.391, 151.367, 502.93, 395.508, -34.18, -288.086, -73.242, 112.305, -146.484, -151.367, 43.945, -551.758, 161.133, 903.32, 649.414, -957.031, -1010.742, 97.656, 922.852, 722.656, -1342.773, 185.547, 78.125, 683.594, 9.766, -820.313, -122.07, 249.023, 9.766, -244.141, -102.539, 78.125, 24.414, 346.68, 659.18, -483.398, -351.563, -117.188, -4.883, 92.773, 385.742, 317.383, 122.07, -546.875, -610.352, 156.25, 327.148, 83.008, -312.5, -24.414, 78.125, 131.836, -39.063, -122.07, 180.664, 131.836, -87.891, -34.18, 29.297, -58.594, -87.891, -19.531, 87.891, 146.484, 151.367, -92.773, 151.367, 4.883, -166.016, 332.031, 883.789, 498.047, -991.211, -1240.234, -307.617, 234.375, 73.242, -53.711, -253.906, 195.313, 175.781, -219.727, -48.828, 97.656, 249.023, 444.336, 200.195, -24.414, -205.078, -190.43, -87.891, 83.008, 156.25, 185.547, 170.898, 4.883, -73.242, -102.539, -195.313, -195.313, -87.891, -24.414, 92.773, 122.07, 166.016, 14.648, -14.648, -48.828, 73.242, -39.063, 146.484, 903.32, 253.906, -1206.055, -571.289, -219.727, 297.852, 1142.578, -58.594, -1381.836, -781.25, 19.531, 400.391, 419.922, 258.789, 200.195, 122.07, 29.297, -39.063, -4.883, 0, 58.594, 117.188, 92.773, 63.477, 9.766, -29.297, -92.773, -97.656, -117.188, 0, 0, 68.359, 39.063, 39.063, 43.945, -78.125, -107.422, -58.594, 9.766, -48.828, 102.539, 73.242, 29.297, 58.594, -14.648, -14.648, -92.773, -9.766, -14.648, -34.18, -131.836, 39.063, -97.656, 58.594, 107.422, -48.828, 87.891, 146.484, -107.422, 68.359, -346.68, 9.766, 39.063, 29.297, 73.242, 53.711, 29.297, 34.18, 126.953, 97.656, 166.016, 166.016, 63.477, 131.836, -73.242, -195.313, -83.008, -224.609, -166.016, -24.414, -24.414, 24.414, -14.648, 0, 0, -48.828, 53.711, -14.648, -58.594, 4.883, -14.648, -4.883, 4.883, 39.063, -39.063, -24.414, 14.648, -14.648, -14.648, -29.297, -34.18, 0, -14.648, -9.766, 14.648, -34.18, -39.063, 4.883, 24.414, -9.766, 14.648, 4.883, -29.297, -9.766, -24.414, 53.711, 9.766, 29.297, 34.18, 9.766, 43.945, -136.719, 39.063, 19.531, -9.766, -4.883, -102.539, -34.18, -78.125, 9.766, -24.414, 29.297, 43.945, 29.297, 53.711, 19.531, 48.828, -4.883, -4.883, -34.18, -9.766, 24.414, -34.18, 14.648, 34.18, -19.531, -24.414, 34.18, 68.359, 48.828, 29.297, 43.945, 14.648, -4.883, 24.414, 9.766, 39.063, 48.828, 34.18, 24.414, 24.414, 4.883, 14.648, -9.766, 4.883, 4.883, -9.766, -34.18, -24.414, -14.648, 0, -29.297, 4.883, 4.883, 24.414, 19.531, -34.18, -48.828, 39.063, 29.297, 43.945, 19.531, 0, 58.594, 24.414, -29.297, 14.648, 19.531, 14.648, 19.531, 9.766, -19.531, -39.063, -34.18, -34.18, -24.414, -39.063, -39.063, 9.766, -19.531, -24.414, -48.828, -29.297, 4.883, -29.297, -63.477, 9.766, -9.766, -19.531, -4.883, -34.18, -14.648, -43.945, -24.414, -4.883, 14.648, -14.648, 4.883, -4.883, -14.648, 4.883, -24.414, -39.063, -4.883, -9.766, -29.297, 34.18, 0, -14.648, 39.063, 39.063, 0, 39.063, 126.953, 0, 19.531, -78.125, 937.5, 1088.867, -29.297, -1499.023, -439.453, -742.188, 200.195, 117.188, -161.133, -488.281, -68.359, -200.195, 9.766, 151.367, 312.5, 258.789, 185.547, 53.711, -9.766, -24.414, -29.297, 48.828, 63.477, 136.719, 209.961, 122.07, 170.898, 48.828, -68.359, -39.063, 39.063, 126.953, 146.484, 14.648, 9.766, -58.594, -78.125, 14.648, -63.477, -48.828, -122.07, -83.008, -4.883, 78.125, 141.602, 273.438, 458.984, -107.422, 43.945, -297.852, -43.945, -346.68, -454.102, 14.648, 341.797, 166.016, 0, -43.945, 87.891, -371.094, 297.852, 14.648, -200.195, -214.844, -102.539, 39.063, -73.242, 0, 29.297, 43.945, 53.711, -4.883, 102.539, 122.07, 78.125, 4.883, -4.883, 0, 0, 34.18, -9.766, -48.828, 29.297, -19.531, -68.359, -34.18, 9.766, -19.531, -19.531, 4.883, 14.648, 14.648, 4.883, -29.297, 34.18, 9.766, 14.648, 53.711, 19.531, 48.828, -19.531, -9.766, -126.953, 4.883, -73.242, -117.188, -122.07, -126.953, -87.891, -29.297, -43.945, -4.883, 48.828, -24.414, 19.531, -34.18, 0, 39.063, 19.531, 14.648, 53.711, 58.594, 34.18, 78.125, 29.297, -43.945, 29.297, -34.18, -68.359, 9.766, -24.414, 14.648, 29.297, -9.766, -29.297, 4.883, -29.297, -48.828, 29.297, 29.297, 185.547, 107.422, -9.766, 0, -43.945, -141.602, -53.711, 29.297, -53.711, 112.305, 112.305, -68.359, -83.008, 107.422, 58.594, 39.063, 151.367, -107.422, 9.766, -92.773, 29.297, -48.828, -9.766, 0, 48.828, 4.883, 63.477, -4.883, -39.063, -39.063, -97.656, -34.18, 14.648, 48.828, -34.18, 34.18, 24.414, 24.414, 34.18, 0, -19.531, 4.883, -19.531, 14.648, 14.648, 19.531, -14.648, 87.891, -4.883, 4.883, -63.477, -4.883, 34.18, -43.945, -102.539, 234.375, -9.766, -112.305, 48.828, -14.648, -83.008, -141.602, -175.781, 156.25, 68.359, -19.531, 39.063, 117.188, 29.297, 117.188, -112.305, -258.789, 268.555, -117.188, 126.953, 39.063, 43.945, -102.539, -161.133, 48.828, 161.133, 273.438, -244.141, -19.531, -63.477, 131.836, 322.266, -24.414, -214.844, -136.719, 73.242, -68.359, -4.883, -24.414, -48.828, -136.719, -43.945, -19.531, -24.414, 63.477, -87.891, -24.414, -9.766, -14.648, -14.648, 92.773, 68.359, 92.773, 53.711, -48.828, -92.773, -166.016, -4.883, 239.258, 278.32, 166.016, -9.766, -273.438, -87.891, -107.422, -180.664, -4.883, 53.711, 317.383, 39.063, -161.133, 92.773, -117.188, 615.234, 292.969, -9.766, -92.773, 53.711, 122.07, 156.25, -981.445, -463.867, 346.68, -673.828, -107.422, 410.156, 253.906, 268.555, -1147.461, -468.75, 585.938, -249.023, -234.375, 410.156, 214.844, -39.063, 131.836, 507.812, 444.336, 634.766, 678.711, -732.422, -1054.688, -1049.805, 1337.891, 278.32, -415.039, -332.031, -1245.117, -693.359, 1357.422, 1508.789, 761.719, 2436.523, 1196.289, -136.719, -551.758, -1044.922, -4179.688, -112.305, -590.82, 585.938, 1259.766, 1596.68, -1840.82, -39.063, -229.492, -1040.039, 634.766, -488.281, 551.758, 1298.828, 58.594, -2128.906, -581.055, 488.281, 483.398, 1601.563, 351.563, -1328.125, 2138.672, -1640.625, -1982.422, 97.656, -874.023, 805.664, 1713.867, 1469.727, -834.961, -185.547, 488.281, -913.086, -698.242, 2812.5, 2211.914, -1142.578, 917.969, -1210.938, 175.781, -644.531, 361.328, -1176.758, 1083.984, 830.078, -2021.484, -1713.867, -1132.813, -419.922, -1250, -122.07, -126.953, 654.297, 742.188, 141.602, -292.969, 73.242, 1464.844, 1162.109, 200.195, 361.328, -249.023, -898.438, -434.57, 107.422, -278.32, 288.086, -19.531, 786.133, -371.094, -571.289, 0, -693.359, 1035.156, 854.492, 141.602, -590.82, 2656.25, 2045.898, -2006.836, -146.484, 244.141, -48.828, -1245.117, 478.516, 288.086, -1279.297, -2006.836, -1225.586, 73.242, 659.18, -327.148, 1650.391, -698.242, -1440.43, 693.359, -34.18, -2612.305, 639.648, 2753.906, 566.406, -14.648, -2182.617, -1049.805, 2592.773, 2202.148, -2612.305, -952.148, 1479.492, 1503.906, 151.367, 1108.398, 546.875, 786.133, -947.266, -2167.969, -571.289, -581.055, 1748.047, -600.586, -522.461, -200.195, 1372.07, -214.844, -834.961, 815.43, 1127.93, -1025.391, -1489.258, -43.945, 561.523, -522.461, 937.5, -185.547, -92.773, 532.227, -405.273, -29.297, 1240.234, -830.078, -1621.094, 449.219, 1489.258, -859.375, -1362.305, 151.367, 156.25, -1289.063, 668.945, 185.547, 1186.523, 1557.617, -532.227, -2851.563, -97.656, 1201.172, 883.789, -268.555, 1347.656, 2397.461, -424.805, -4370.117, -2724.609, 2319.336, 1816.406, 747.07, -175.781, -126.953, -488.281, -141.602, -1464.844, 1518.555, 1196.289, 97.656, -561.523, -195.313, -278.32, 600.586, 766.602, -771.484, -1367.188, -87.891, 898.438, 24.414, -781.25, 493.164, -136.719, 332.031, 639.648, 1303.711, -737.305, -249.023, -361.328, -688.477, 1762.695, -512.695, -2612.305, 146.484, 1171.875, 844.727, -1206.055, -1162.109, 1391.602, 1123.047, 737.305, 205.078, -2880.859, 1503.906, 1489.258, -976.563, -3144.531, 87.891, 1591.797, 668.945, 214.844, 58.594, -2661.133, 1220.703, 708.008, -1826.172, 375.977, 1367.188, 332.031, 14.648, 1191.406, 1152.344, -1308.594, -2309.57, 219.727, 1567.383, 571.289, -1835.938, -634.766, 405.273, 546.875, -190.43, 161.133, 1640.625, -830.078, -976.563, -234.375, 815.43, 1318.359, 1166.992, -917.969, -722.656, -1005.859, -2094.727, 1552.734, 1499.023, -571.289, 351.563, -1137.695, -1079.102, -156.25, 898.438, 625, 302.734, 166.016, 795.898, -239.258, 375.977, -1157.227, -537.109, -405.273, -478.516, 1088.867, 732.422, -253.906, -1323.242, 854.492, 87.891, -175.781, 1708.984, 712.891, -600.586, -3085.938, 468.75, 1601.563, 29.297, -361.328, -322.266, 786.133, 234.375, -644.531, 195.313, 629.883, -678.711, -336.914, -107.422, -644.531, 625, 63.477, -625, -229.492, 1625.977, -751.953, -678.711, 1430.664, 805.664, 136.719, -2294.922, -537.109, 1933.594, 517.578, -537.109, 302.734, -126.953, -2167.969, -1240.234, 1220.703, 131.836, 1054.688, 1000.977, -1079.102, -800.781, -1816.406, 1967.774, 1215.82, -68.359, 1142.578, 1298.828, -1210.938, -3251.953, 29.297, 1391.602, 864.258, -756.836, -122.07, 2470.703, 1152.344, -3813.477, -1000.977, 2368.164, 39.063, -1611.328, -63.477, -224.609, 258.789, 307.617, -19.531, 1142.578, 2202.148, -605.469, -2944.336, 361.328, 1469.727, 1372.07, -1547.852, -3286.133, 2187.5, 1098.633, -727.539, -815.43, 53.711, -327.148, 385.742, -1254.883, 2343.75, 53.711, -166.016, -512.695, 2094.727, 1030.273, -1962.891, -2021.484, 698.242, 1479.492, 366.211, -1274.414, -273.438, -649.414, -1176.758, 644.531, 1787.109, 532.227, 1220.703, 117.188, 722.656, -3891.602, -1220.703, 541.992, -1132.813, 947.266, 2534.18, 693.359, -781.25, -2167.969, -1494.141, 1850.586, 581.055, -424.805, 576.172, -1757.813, -1303.711, 2407.227, 1000.977, 366.211, 2983.398, 1079.102, -2612.305, -1762.695, 839.844, -473.633, 957.031, 268.555, -3281.25, -1557.617, 2094.727, 488.281, -107.422, 2153.32, 712.891, -1904.297, -53.711, 97.656, -1303.711, 151.367, 1630.859, 317.383, -532.227, -1713.867, 683.594, 1010.742, 1513.672, 429.688, -3090.82, -688.477, 2055.664, 1215.82, -468.75, -3793.945, 3027.344, 1000.977, -356.445, -2485.352, -39.063, 439.453, 1142.578, 756.836, -2333.984, -1240.234, 1298.828, 1650.391, 356.445, -541.992, -893.555, 58.594, 2666.016, 683.594, -2739.258, -781.25, -1894.531, 1230.469, 1455.078, -449.219, 9.766, -839.844, 625, 1469.727, 371.094, -185.547, 429.688, -1596.68, -1533.203, 800.781, 424.805, -1381.836, -478.516, 537.109, 693.359, 1943.359, 2397.461, 317.383, -3608.398, -2294.922, 917.969, 415.039, 205.078, -146.484, -39.063, 576.172, 1347.656, 1142.578, -2602.539, -849.609, -97.656, 966.797, 87.891, -224.609, -239.258, -351.563, 434.57, 498.047, 156.25, 39.063, 180.664, 141.602, -83.008, 971.68, 786.133, -1230.469, -2910.156, 424.805, 698.242, 756.836, 654.297, 527.344, -1538.086, -595.703, -151.367, 126.953, 1127.93, 3173.828, 1816.406, -3383.789, -4125.977, 620.117, 849.609, 151.367, -166.016, -136.719, -14.648, 190.43, 336.914, 512.695, 434.57, 302.734, 58.594, -229.492, -356.445, -317.383, -214.844, -63.477, 146.484, 317.383, 239.258, 156.25, 14.648, -229.492, -283.203, -195.313, -200.195, -19.531, 87.891, 698.242, 976.563, 312.5, -434.57, -722.656, -14.648, -87.891, 1069.336, 24.414, -2480.469, -1074.219, 781.25, 419.922, 166.016, -83.008, -87.891, -39.063, 78.125, 175.781, 302.734, 297.852, 214.844, 117.188, -19.531, -112.305, -166.016, -29.297, -39.063, 73.242, 92.773, 122.07, 87.891, -4.883, -102.539, -161.133, -146.484, -136.719, -63.477, 73.242, 97.656, 258.789, 151.367, 175.781, -258.789, -283.203, -312.5, 73.242, -48.828, 312.5, 141.602, -219.727, 68.359, 332.031, 19.531, -205.078, -190.43, -48.828, -9.766, -68.359, -63.477, 14.648, 0, 29.297, 43.945, 34.18, 97.656, 97.656, 112.305, 29.297, -19.531, 39.063, 58.594, 68.359, 14.648, 29.297, -9.766, -4.883, 34.18, 14.648, 380.859, 493.164, -341.797, -112.305, -732.422, -156.25, 551.758, 209.961, -9.766, -322.266, -292.969, -92.773, 78.125, -19.531, 229.492, 39.063, -24.414, -9.766, -34.18, -4.883, 43.945, 29.297, 48.828, 68.359, 48.828, 24.414, -39.063, -19.531, -43.945, -24.414, -4.883, -58.594, 43.945, 4.883, 0, 4.883, -48.828, -14.648, 9.766, 48.828, 19.531, -14.648, 29.297, 156.25, 14.648, 92.773, 166.016, 146.484, -410.156, -283.203, -244.141, -43.945, -39.063, 14.648, -19.531, -4.883, 0, 63.477, 78.125, 205.078, 122.07, 34.18, -9.766, 43.945, 9.766, -39.063, -92.773, -4.883, 29.297, 0, 0, -4.883, -34.18, 0, -34.18, 0, -73.242, -68.359, -14.648, -29.297, 4.883, -9.766, 34.18, -14.648, 14.648, -24.414, -34.18, -19.531, -43.945, 29.297, 34.18, 29.297, 39.063, -34.18, 4.883, -19.531, -43.945, 24.414, 14.648, 14.648, -19.531, 29.297, -14.648, 0, -19.531, -34.18, -39.063, -24.414, -19.531, 4.883, 29.297, 29.297, 0, 34.18, -4.883, -14.648, 9.766, -9.766, -9.766, 19.531, -19.531, -9.766, 4.883, -63.477, -24.414, -4.883, 14.648, -4.883, 53.711, 83.008, 131.836, 29.297, 39.063, 0, -43.945, 92.773, -24.414, 68.359, 146.484, 63.477, -268.555, -195.313, -48.828, -288.086, -292.969, 34.18, 83.008, 63.477, -4.883, 214.844, 68.359, -43.945, 161.133, 190.43, 58.594, -9.766, -53.711, -19.531, -24.414, 58.594, 39.063, 48.828, 107.422, 78.125, 24.414, 87.891, 9.766, -24.414, -73.242, -43.945, 4.883, -29.297, -34.18, -14.648, 9.766, -4.883, -68.359, -83.008, -48.828, -43.945, -53.711, -43.945, -63.477, -24.414, -68.359, 29.297, -39.063, -58.594, 19.531, -4.883, 24.414, 9.766, 14.648, 34.18, 9.766, 29.297, 63.477, -9.766, -19.531, 34.18, -24.414, 9.766, 73.242, 29.297, 24.414, 24.414, -9.766, -4.883, 24.414, 19.531, -19.531, 34.18, -53.711, -43.945, -34.18, -39.063, -39.063, -48.828, 14.648, -24.414, -9.766, -34.18, -29.297, -29.297, 14.648, 24.414, -4.883, -68.359, -34.18, 78.125, 29.297, -63.477, 9.766, -302.734, 493.164, 249.023, -24.414, -615.234, 68.359, 97.656, -395.508, -102.539, 170.898, 53.711, -43.945, 9.766, 24.414, 4.883, 39.063, 117.188, 112.305, 87.891, 9.766, 9.766, -29.297, 14.648, 43.945, 136.719, 117.188, 68.359, 4.883, 239.258, 415.039, 122.07, -473.633, -644.531, -302.734, -34.18, 195.313, 34.18, -29.297, -146.484, -175.781, 214.844, 122.07, 131.836, -24.414, 39.063, 24.414, -19.531, -48.828, -53.711, -19.531, 58.594, 48.828, 63.477, 92.773, 43.945, 58.594, 112.305, 63.477, 24.414, 39.063, -92.773, 58.594, -180.664, 19.531, 156.25, -78.125, -136.719, -166.016, 34.18, 141.602, -73.242, 14.648, 87.891, 161.133, 200.195, -361.328, -195.313, 43.945, 312.5, 395.508, -292.969, 0, 190.43, -273.438, -239.258, 34.18, -219.727, 0, -29.297, -4.883, -4.883, -48.828, 58.594, 73.242, 43.945, 14.648, 43.945, 4.883, -83.008, -48.828, -34.18, -19.531, 73.242, 53.711, 14.648, -4.883, 14.648, -102.539, -39.063, -29.297, 19.531, 48.828, -4.883, 0, 9.766, 92.773, 0, -68.359, -97.656, -34.18, -19.531, -19.531, -19.531, 19.531, 14.648, 19.531, 209.961, 131.836, -34.18, -78.125, 58.594, -48.828, -19.531, -78.125, 170.898, 43.945, 180.664, -9.766, -102.539, -39.063, 34.18, -292.969, -102.539, -24.414, 78.125, -19.531, -131.836, 126.953, 34.18, 78.125, 48.828, -58.594, 117.188, 136.719, -112.305, -161.133, -112.305, -4.883, -29.297, 39.063, 9.766, -14.648, 73.242, 43.945, 39.063, 97.656, 43.945, 58.594, -14.648, 0, 34.18, 180.664, -9.766, -200.195, 4.883, -63.477, -24.414, 73.242, -43.945, -146.484, 190.43, -9.766, -302.734, -156.25, 83.008, 122.07, 292.969, 263.672, -288.086, -209.961, -53.711, -151.367, 224.609, 9.766, 83.008, 29.297, -122.07, -136.719, 73.242, 73.242, 14.648, 166.016, -141.602, 141.602, -185.547, -205.078, 219.727, -107.422, -200.195, 97.656, 107.422, 63.477, 39.063, -39.063, -14.648, 97.656, -53.711, -4.883, 24.414, -19.531, -29.297, 39.063, 0, 83.008, 170.898, -327.148, 58.594, 4.883, -117.188, -29.297, 0, -4.883, 4.883, 0, -63.477, 29.297, -48.828, 68.359, 4.883, 24.414, 34.18, -43.945, -19.531, -34.18, -43.945, -14.648, 14.648, 68.359, 58.594, 34.18, 97.656, -92.773, 48.828, 68.359, -4.883, -107.422, -146.484, 161.133, 131.836, -14.648, -400.391, 78.125, 234.375, -185.547, -4.883, 48.828, 39.063, 0, -29.297, -195.313, 151.367, -48.828, -170.898, 102.539, 58.594, -209.961, 24.414, 4.883, 102.539, 527.344, 532.227, 146.484, -776.367, -229.492, 302.734, 371.094, 78.125, -512.695, 63.477, -102.539, 190.43, 43.945, 161.133, -224.609, -312.5, -156.25, 14.648, 205.078, -190.43, -463.867, 180.664, 258.789, 336.914, 366.211, -522.461, 268.555, -834.961, -205.078, -224.609, 214.844, 649.414, 493.164, -766.602, -234.375, 786.133, -527.344, 585.938, -170.898, -385.742, -126.953, 253.906, 1000.977, 415.039, -244.141, -537.109, 1459.961, -87.891, -1416.016, -512.695, 566.406, -415.039, 546.875, -1088.867, 478.516, 708.008, 219.727, 683.594, 888.672, -1191.406, -2451.172, 136.719, 502.93, 1982.422, 864.258, -2314.453, -1860.352, 913.086, -434.57, 1533.203, 625, -1337.891, 258.789, -253.906, -87.891, -258.789, -1059.57, 1020.508, 3447.266, 1660.156, -761.719, -2343.75, -1767.578, -205.078, 1787.109, -332.031, -1875, 1884.766, 1943.359, -678.711, -1933.594, -507.812, 1801.758, 63.477, 48.828, 2705.078, 996.094, -2802.734, -791.016, -2241.211, 820.313, 434.57, 292.969, -1220.703, -2387.695, -703.125, 1655.273, 776.367, -937.5, -1728.516, 1308.594, 1914.063, 1230.469, 351.563, 771.484, 1176.758, -947.266, -1625.977, -1040.039, 73.242, -346.68, -576.172, 73.242, 610.352, 732.422, 834.961, 517.578, -2431.641, -170.898, 1015.625, 1098.633, 336.914, 595.703, 517.578, -1557.617, -800.781, 566.406, 1269.531, 1425.781, -1445.313, -776.367, 698.242, -917.969, -68.359, 541.992, 112.305, -2304.688, 410.156, 112.305, -625, 1284.18, 986.328, 214.844, -1103.516, -2216.797, -1582.031, 947.266, 2792.969, 1118.164, -4091.797, 468.75, 361.328, 1347.656, 986.328, -92.773, -1132.813, -791.016, 1484.375, 908.203, 473.633, -673.828, 551.758, 2363.281, -1718.75, -1870.117, 639.648, 1430.664, -292.969, -2690.43, 991.211, 283.203, -9.766, 107.422, -1142.578, 688.477, -551.758, 258.789, 39.063, 1040.039, 761.719, 522.461, 375.977, -1269.531, -444.336, -136.719, -410.156, 292.969, 791.016, -659.18, -1079.102, -3002.93, 522.461, 834.961, 2089.844, 1684.57, -1987.305, -1103.516, 1020.508, 97.656, -292.969, 610.352, 244.141, 200.195, -258.789, 205.078, 112.305, 917.969, -1103.516, 351.563, 273.438, 312.5, -1953.125, 205.078, 1254.883, -278.32, -195.313, -58.594, 742.188, 195.313, -556.641, -161.133, 122.07, -581.055, -1098.633, 883.789, 751.953, -561.523, -585.938, -805.664, 1845.703, 644.531, -1333.008, -29.297, 1733.398, 1811.523, -2114.258, -1708.984, 1206.055, 1035.156, -1782.227, 634.766, 458.984, -2377.93, -234.375, 1098.633, 1494.141, -961.914, -43.945, -854.492, 2500, -83.008, 429.688, -610.352, -1323.242, -1074.219, -322.266, 1875, 1479.492, -2211.914, -571.289, -761.719, 1274.414, 302.734, 190.43, -1474.609, -380.859, 820.313, 424.805, 786.133, 219.727, 1611.328, 1264.648, -2954.102, -2031.25, 1782.227, 1323.242, -625, -644.531, -1157.227, -253.906, -195.313, 1069.336, -551.758, 878.906, 620.117, -971.68, 122.07, 1250, 820.313, -2084.961, 810.547, 58.594, -434.57, -610.352, -327.148, -688.477, 1596.68, 805.664, -1503.906, -395.508, -92.773, -341.797, -112.305, 229.492, 498.047, 917.969, 703.125, -346.68, 629.883, 63.477, -273.438, 654.297, 1743.164, 73.242, -4213.867, 405.273, 546.875, 424.805, -156.25, 1269.531, -878.906, -200.195, -664.063, 488.281, 576.172, -1059.57, -620.117, 952.148, 649.414, 73.242, -1743.164, 2001.953, 649.414, -1923.828, -1479.492, 170.898, 610.352, 1083.984, -34.18, -732.422, 24.414, 922.852, 512.695, -263.672, 712.891, 1743.164, -659.18, -1718.75, -1274.414, -2641.602, 1342.773, 1401.367, -63.477, 571.289, 1083.984, -1108.398, -1186.523, 1318.359, -34.18, 1191.406, 92.773, 776.367, -444.336, -3022.461, 68.359, 883.789, 102.539, 1059.57, -2104.492, -454.102, 849.609, -170.898, -53.711, 400.391, 415.039, -869.141, -991.211, 620.117, 981.445, 29.297, 351.563, 581.055, 493.164, -751.953, -146.484, 1372.07, 43.945, -1958.008, 1401.367, 585.938, -2583.008, 747.07, 424.805, -1435.547, -546.875, 332.031, -458.984, 942.383, 58.594, 473.633, 839.844, 195.313, -786.133, 1020.508, -83.008, -1323.242, 668.945, 625, -214.844, 615.234, -766.602, -1552.734, -839.844, 1499.023, 620.117, 107.422, -1782.227, 2597.656, 1308.594, -942.383, -341.797, -249.023, -2324.219, 126.953, 175.781, 776.367, 996.094, 1074.219, 19.531, -932.617, -3149.414, 1499.023, 278.32, 200.195, 1093.75, 932.617, -688.477, -2353.516, -283.203, -463.867, 2861.328, 3369.141, -712.891, -3984.375, 0, 1884.766, 1918.945, -1767.578, -4404.297, -68.359, 1406.25, 1113.281, 1088.867, 312.5, 434.57, -927.734, -1440.43, 209.961, 791.016, 2089.844, -1191.406, -253.906, 434.57, 1464.844, 483.398, 400.391, 0, -83.008, -278.32, -4013.672, -644.531, 107.422, 1069.336, 771.484, -2148.438, -1279.297, 1577.148, -605.469, 288.086, 2250.977, 2993.164, -537.109, -4267.578, -903.32, 1333.008, -1049.805, 1801.758, 2617.188, 585.938, -1982.422, -1870.117, 1245.117, -2148.438, -229.492, 2436.523, 2602.539, -2172.852, -3901.367, 1547.852, 854.492, -1137.695, 585.938, 1269.531, 463.867, 1884.766, 468.75, -4418.945, -292.969, 2905.273, 161.133, 185.547, -1064.453, 200.195, 29.297, -1333.008, 571.289, 893.555, -278.32, 19.531, -395.508, 2333.984, 68.359, -2695.313, -312.5, -83.008, -297.852, 903.32, 888.672, -1342.773, -1210.938, 1206.055, 375.977, 815.43, 219.727, 219.727, 751.953, 273.438, -1391.602, -1005.859, 507.812, 9.766, 659.18, -195.313, -1142.578, -400.391, 263.672, 346.68, 14.648, 551.758, 688.477, 488.281, -585.938, -537.109, -527.344, 659.18, 771.484, -400.391, -625, -297.852, 375.977, 424.805, 39.063, -39.063, 737.305, -1933.594, -942.383, 737.305, 820.313, 341.797, -83.008, 390.625, -874.023, 922.852, 322.266, -1464.844, -302.734, 1020.508, 239.258, 48.828, 136.719, -585.938, -493.164, 29.297, 302.734, 444.336, -659.18, 161.133, -43.945, -317.383, 185.547, 92.773, -48.828, 14.648, 19.531, -48.828, -390.625, 288.086, 380.859, 175.781, 87.891, 83.008, -297.852, -219.727, -615.234, 73.242, 722.656, 375.977, -634.766, 434.57, -346.68, -434.57, -385.742, 668.945, 659.18, 649.414, -561.523, -1137.695, -351.563, 463.867, 161.133, -19.531, -53.711, -53.711, -43.945, -214.844, 302.734, 556.641, -244.141, 234.375, 39.063, -190.43, -190.43, -263.672, -117.188, 205.078, 268.555, 297.852, 170.898, -19.531, -126.953, -185.547, -224.609, -214.844, -92.773, 0, 117.188, 29.297, -73.242, -53.711, 58.594, 48.828, 48.828, 73.242, 737.305, 9.766, -791.016, -190.43, 1259.766, -541.992, -317.383, -727.539, -48.828, -332.031, 43.945, 131.836, 136.719, 219.727, 239.258, 258.789, 224.609, 151.367, 78.125, 78.125, 9.766, -53.711, -24.414, 14.648, 126.953, 58.594, 58.594, -19.531, -19.531, -87.891, -78.125, -97.656, -34.18, 9.766, -39.063, 58.594, -24.414, -58.594, -58.594, -39.063, -43.945, -9.766, 9.766, 9.766, 83.008, 48.828, 68.359, 14.648, 107.422, 117.188, -122.07, 136.719, -24.414, -53.711, -136.719, 24.414, -53.711, -53.711, -58.594, -97.656, 68.359, 24.414, -131.836, 39.063, 107.422, 112.305, 29.297, 14.648, -19.531, -4.883, 14.648, 29.297, -14.648, 43.945, 63.477, 83.008, -4.883, -9.766, -34.18, -48.828, 0, -29.297, -29.297, -24.414, -43.945, 34.18, -14.648, -4.883, 0, -14.648, 14.648, -9.766, -19.531, -68.359, 4.883, 9.766, -14.648, -19.531, -68.359, -63.477, -53.711, -4.883, 9.766, -19.531, -24.414, 24.414, -4.883, -4.883, 14.648, 29.297, 19.531, 0, 34.18, -4.883, -14.648, 9.766, 0, -34.18, 4.883, -24.414, 4.883, -9.766, -19.531, 19.531, -14.648, 24.414, -14.648, 0, -43.945, 9.766, -53.711, -39.063, 4.883, 39.063, -43.945, -39.063, 19.531, 14.648, -19.531, 9.766, -29.297, -24.414, 4.883, -34.18, -24.414, 29.297, 48.828, 43.945, 43.945, 19.531, -34.18, 29.297, 24.414, 9.766, 43.945, 39.063, 4.883, 24.414, 9.766, -9.766, 73.242, 29.297, 53.711, 14.648, -19.531, 34.18, 14.648, 24.414, -39.063, -29.297, 29.297, 0, 0, -63.477, -29.297, -19.531, -14.648, 48.828, -14.648, 0, -9.766, 9.766, 14.648, -19.531, 14.648, 24.414, 14.648, -29.297, -24.414, 0, 4.883, 34.18, 4.883, 19.531, 34.18, -29.297, 19.531, -43.945, -29.297, 34.18, -53.711, 0, -9.766, -19.531, -4.883, -43.945, -19.531, -4.883, -29.297, -9.766, -34.18, 14.648, -14.648, -29.297, -24.414, 24.414, -39.063, 29.297, 24.414, -4.883, -19.531, -53.711, -4.883, 39.063, 0, -14.648, 4.883, 19.531, 4.883, 19.531, 4.883, 14.648, -43.945, 19.531, 24.414, 9.766, 39.063, 9.766, 4.883, -24.414, 9.766, -19.531, -9.766, -9.766, 24.414, 29.297, 4.883, -14.648, -29.297, -4.883, -34.18, -48.828, -9.766, 29.297, -14.648, 4.883, -19.531, -29.297, 9.766, -43.945, 9.766, -19.531, 14.648, -4.883, 0, 19.531, 9.766, 53.711, 34.18, -39.063, 9.766, 19.531, 48.828, 24.414, 14.648, 0, -14.648, -9.766, -9.766, -29.297, 53.711, 63.477, -29.297, 39.063, 14.648, -48.828, 0, 0, 97.656, 131.836, -4.883, -19.531, 48.828, -39.063, 122.07, 429.688, 322.266, 156.25, -234.375, -268.555, -229.492, -297.852, -351.563, -4.883, 327.148, 273.438, 151.367, -883.789, -883.789, -112.305, 332.031, 371.094, 200.195, 53.711, 14.648, -19.531, 9.766, 156.25, 273.438, 239.258, 239.258, 146.484, -4.883, -131.836, -107.422, 0, 97.656, 53.711, 146.484, 92.773, 29.297, 24.414, 63.477, 4.883, -92.773, -239.258, -175.781, -83.008, 48.828, 29.297, -29.297, 24.414, -141.602, -224.609, -244.141, -185.547, -78.125, -14.648, 83.008, 180.664, -68.359, -307.617, -258.789, 190.43, 34.18, 39.063, -78.125, 380.859, 24.414, -83.008, 48.828, 92.773, 161.133, -68.359, -29.297, -14.648, -58.594, -19.531, 43.945, 112.305, 78.125, -34.18, 24.414, 43.945, -29.297, 0, -87.891, -34.18, -9.766, -4.883, -43.945, -19.531, -19.531, -48.828, -4.883, -34.18, -43.945, -39.063, -19.531, 53.711, 63.477, -34.18, -4.883, -4.883, 0, 34.18, 34.18, 24.414, -4.883, 29.297, -39.063, -29.297, 9.766, 58.594, 24.414, 68.359, -19.531, -14.648, -39.063, -9.766, -39.063, -53.711, -4.883, 97.656, 0, -92.773, -4.883, -24.414, 68.359, 68.359, 14.648, -73.242, -53.711, -39.063, -34.18, -24.414, 73.242, 4.883, 68.359, 29.297, 43.945, 14.648, 34.18, -68.359, -39.063, -14.648, -43.945, -14.648, -68.359, -24.414, 29.297, 214.844, 43.945, -43.945, -156.25, 34.18, -9.766, -156.25, 209.961, 737.305, -166.016, -493.164, -307.617, 34.18, 4.883, 483.398, -87.891, -43.945, 122.07, 92.773, 136.719, -92.773, -24.414, -73.242, -117.188, 107.422, 29.297, -43.945, -83.008, -53.711, -19.531, -19.531, 43.945, 63.477, 63.477, 9.766, -29.297, -48.828, -68.359, -19.531, -29.297, 29.297, 63.477, 14.648, 19.531, 43.945, 48.828, -29.297, -9.766, -9.766, 9.766, 126.953, 161.133, -170.898, -68.359, -4.883, 4.883, 19.531, -141.602, 9.766, 53.711, -29.297, 4.883, 53.711, -4.883, -146.484, -24.414, 34.18, -9.766, -83.008, -107.422, -97.656, 83.008, 68.359, -34.18, 107.422, 9.766, -19.531, -43.945, -92.773, -29.297, 117.188, 87.891, 97.656, -63.477, -39.063, -141.602, -175.781, -87.891, -68.359, 83.008, 180.664, 439.453, 190.43, -166.016, -273.438, -307.617, -371.094, -146.484, -9.766, 346.68, 195.313, 185.547, -39.063, 19.531, 273.438, -14.648, 107.422, 449.219, 380.859, -444.336, -786.133, 375.977, 244.141, 122.07, -185.547, -151.367, -571.289, -107.422, 356.445, 14.648, 209.961, 166.016, -405.273, 136.719, 444.336, -551.758, 444.336, 991.211, -512.695, -717.773, 83.008, -668.945, -1645.508, 585.938, 893.555, -859.375, -263.672, 771.484, 659.18, 1347.656, 952.148, -302.734, -1196.289, -698.242, 175.781, 434.57, 966.797, 424.805, -2583.008, -449.219, 1977.539, 1235.352, -791.016, -380.859, -844.727, -888.672, 1777.344, -517.578, -478.516, 307.617, -307.617, 644.531, 1284.18, 1684.57, -952.148, 581.055, 253.906, -810.547, -1586.914, -4165.039, -200.195, 869.141, 1166.992, 839.844, 947.266, 2314.453, 1757.813, -2382.813, 668.945, 434.57, -1328.125, -766.602, -224.609, -1513.672, -419.922, 14.648, -1059.57, 1093.75, 620.117, -1464.844, -185.547, 1860.352, 48.828, -2124.023, -1254.883, 1235.352, 1748.047, 136.719, 385.742, 1337.891, -825.195, -659.18, 1806.641, 14.648, -1230.469, -351.563, 410.156, -449.219, -957.031, 864.258, 405.273, 92.773, -107.422, 830.078, 1245.117, -1816.406, -507.812, -327.148, -102.539, 307.617, 864.258, -502.93, -1948.242, 73.242, 717.773, 249.023, 366.211, 605.469, 29.297, -620.117, 683.594, 43.945, -883.789, 781.25, 175.781, -1430.664, 932.617, -1303.711, 58.594, 693.359, 585.938, -34.18, -1206.055, 19.531, -92.773, 1206.055, 2001.953, 512.695, -903.32, 737.305, 332.031, 73.242, -1850.586, -620.117, 366.211, 795.898, -102.539, -478.516, -2104.492, 1411.133, -190.43, -1762.695, 493.164, 683.594, 693.359, -761.719, 366.211, 68.359, -278.32, -751.953, 278.32, 68.359, 561.523, -507.812, 971.68, 1494.141, -244.141, -830.078, -1928.711, -3295.898, 1674.805, 1572.266, 561.523, 854.492, 761.719, 488.281, -3964.844, 1386.719, -219.727, 1386.719, 390.625, 234.375, 659.18, -678.711, 644.531, 825.195, -3403.32, -1352.539, 2788.086, 1660.156, -683.594, -756.836, -1904.297, 1123.047, 805.664, 375.977, -327.148, 415.039, 1357.422, -336.914, -1542.969, 947.266, 483.398, -756.836, -1879.883, 146.484, 1401.367, 390.625, -571.289, -1186.523, 1342.773, 825.195, -1079.102, -820.313, 649.414, -219.727, -1206.055, 1245.117, 2778.32, -1279.297, -1811.523, 1230.469, 307.617, 668.945, -1728.516, -122.07, 1289.063, 151.367, 151.367, 2958.984, -1596.68, -2983.398, -654.297, 1049.805, -683.594, 517.578, 1108.398, 1425.781, -1967.774, -2690.43, 258.789, -87.891, 1059.57, 1669.922, -102.539, -2358.398, -2045.898, 1791.992, 1567.383, 507.812, 1704.102, -161.133, -830.078, -957.031, 952.148, -2919.922, 1469.727, 2880.859, 1513.672, -2636.719, -2065.43};
    ma::io::File file;
    file.open(OPENMA_TDD_PATH_IN("elite/22XXX/22XXXC0B.EMG"), ma::io::Mode::In);
    ma::io::HandlerReader reader(&file);
    ma::Node root("root");
    TS_ASSERT_EQUALS(reader.read(&root), true);
    TS_ASSERT_EQUALS(reader.errorCode(), ma::io::Error::None);
    TS_ASSERT_EQUALS(reader.errorMessage(), std::string{});
    TS_ASSERT_EQUALS(root.children().size(), 1u);
    
    auto analogs = root.findChildren<ma::TimeSequence*>();
    TS_ASSERT_EQUALS(analogs.size(), 8u);
    for (auto analog : analogs)
    {
      TS_ASSERT_EQUALS(analog->startTime(), 0.0);
      TS_ASSERT_EQUALS(analog->sampleRate(), 500.0);
      TS_ASSERT_EQUALS(analog->components(), 1u);
      TS_ASSERT_EQUALS(analog->samples(), samples);
      TS_ASSERT_EQUALS(analog->unit(), "mV");
    }
    TS_ASSERT_EQUALS(analogs[0]->name(), "L_RF");
    TS_ASSERT_EQUALS(analogs[1]->name(), "L_SM");
    TS_ASSERT_EQUALS(analogs[2]->name(), "L_TA");
    TS_ASSERT_EQUALS(analogs[3]->name(), "L_GAM");
    TS_ASSERT_EQUALS(analogs[4]->name(), "R_RF");
    TS_ASSERT_EQUALS(analogs[5]->name(), "R_SM");
    TS_ASSERT_EQUALS(analogs[6]->name(), "R_TA");
    TS_ASSERT_EQUALS(analogs[7]->name(), "R_GAM");
    for (unsigned i = 0 ; i < samples ; ++i)
      TS_ASSERT_DELTA(analogs[0]->data()[i], ref_L_RF[i], 1e-3);
  };
};

CXXTEST_SUITE_REGISTRATION(EliteEmgReaderTest)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, capability)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, supportedTrialFormats)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectNoDevice)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectDeviceNotOpen)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectEmptyFile)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectFail)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectOk)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, queryOkOne)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, queryOkTwo)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, queryOkThree)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectVariantEmr)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, detectVariantEmf)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, file1123xa01G)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, file1123xa01F)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, file1123xa01R)
CXXTEST_TEST_REGISTRATION(EliteEmgReaderTest, file22XXXC0B)